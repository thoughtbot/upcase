<% content_for :nav do -%>
  <ul>
    <li><%= link_to "Courses", admin_courses_path %></li>
    <li><%= link_to 'New Course', new_admin_course_path, :id => 'new-course' %></li>
    <li><%= link_to "Coupons", admin_coupons_path %></li>
  </ul>
<% end -%>

<ul id='course_list'>
  <% @courses.each do |course| %>
    <%= content_tag_for(:li, course, :class => 'course-list cool-list', :"data-course_id" => course.id) do %>
      <h3>
        <%= link_to course.name, edit_admin_course_path(course) %>
        <%= link_to 'New Section', new_admin_course_section_path(course), :class => 'new-section', :id => "new-section-#{course.id}" %>
      </h3>
      <ul>
        <% course.sections.each do |section| %>
          <li><%= link_to section.date_range, edit_admin_course_section_path(course, section), :id => dom_id(section) %></li>
        <% end %>
      </ul>
    <% end %>
  <% end %>
</ul>
<% content_for :javascript do %>
  <%= javascript_tag do %>
    $(function() {
      $('#course_list').sortable({ axis: 'y' })
      $('#course_list').bind('sortupdate', function(event, ui) {
        course_id = ui.item.data("course_id");
        position = $(this).children().index(ui.item) + 1;
        $.ajax("/admin/courses/"+course_id+"/position.js", {
          data: { position: position },
          type: "PUT"
        });
      });
    });
  <% end %>
<% end %>
